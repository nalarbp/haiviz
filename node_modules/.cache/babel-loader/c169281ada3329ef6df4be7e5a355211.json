{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Volumes/DATA/BUDI/APP_DEV/haiviz-v04/src/viz_DataTable/comp_DataTable.js\";\n\n/* ============================================================================\n============================================================================ */\nimport React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { deactivateChart, setSelectedData } from \"../action/index\";\nimport { Row, Col, Card, Button, Table, Skeleton, Input, Space } from \"antd\";\nimport DataTableSettings from \"./comp_DataTable_Settings\";\nimport { DragOutlined, SettingOutlined, CloseOutlined, FilterOutlined } from \"@ant-design/icons\";\nimport { dateToStringIS08601, getIsolateDataHeader } from \"../utils/utils\"; //import { ExportToCsv } from \"export-to-csv\";\n\nimport withMeasure from \"../hocs/withMeasure\";\nvar dimensions = [\"width\", \"height\"];\n\nvar _ = require(\"lodash\");\n\nvar DataTable = function DataTable(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isDrawerVisible = _useState2[0],\n      setisDrawerVisible = _useState2[1];\n\n  var isolateData = _.cloneDeep(Array.from(props.data.values())); // const [searchText, setSearchText] = useState(null);\n  // const [searchedColumn, setSearchedColumn] = useState(null);\n\n\n  var dataTable = {\n    headers: null,\n    cells: null\n  };\n  var cells = isolateData && isolateData[0] ? isolateData.map(function (d, idx) {\n    return {\n      key: idx,\n      isolate_name: d.isolate_name,\n      isolate_species: d.isolate_species,\n      isolate_sourceType: d.isolate_sourceType,\n      isolate_sourceName: d.isolate_sourceName,\n      isolate_colDate: dateToStringIS08601(d.isolate_colDate),\n      isolate_colLocation: d.isolate_colLocation,\n      profile_1: d.profile_1,\n      profile_2: d.profile_2,\n      profile_3: d.profile_3\n    };\n  }) : null;\n\n  var _useState3 = useState(cells),\n      _useState4 = _slicedToArray(_useState3, 2),\n      tableCells = _useState4[0],\n      setTableCells = _useState4[1];\n\n  var tableHeaders = isolateData && isolateData[0] ? createHeaders(isolateData) : null; //USE EFFECTS\n\n  useEffect(function () {\n    if (props.selectedData) {\n      var _tableCells = isolateData.map(function (d, idx) {\n        return {\n          key: idx,\n          isolate_name: d.isolate_name,\n          isolate_species: d.isolate_species,\n          isolate_sourceType: d.isolate_sourceType,\n          isolate_sourceName: d.isolate_sourceName,\n          isolate_colDate: dateToStringIS08601(d.isolate_colDate),\n          isolate_colLocation: d.isolate_colLocation,\n          profile_1: d.profile_1,\n          profile_2: d.profile_2,\n          profile_3: d.profile_3\n        };\n      });\n\n      if (props.selectedData.length > 0) {\n        var filteredCells = _tableCells.filter(function (d) {\n          return props.selectedData.indexOf(d.isolate_name) !== -1;\n        });\n\n        setTableCells(filteredCells);\n      } else {\n        setTableCells(_tableCells);\n      }\n    }\n  }, [props.selectedData]); // useEffect(() => {\n  //   if (\n  //     searchText &&\n  //     searchedColumn &&\n  //     searchText !== \"\" &&\n  //     searchedColumn !== \"\"\n  //   ) {\n  //     let selectedData = [];\n  //     if (searchedColumn === \"isolate_colDate\") {\n  //       let filteredCells = isolateData.filter(function(d) {\n  //         return dateToStringIS08601(d[searchedColumn])\n  //           .toString()\n  //           .toLowerCase()\n  //           .includes(searchText.toLowerCase());\n  //       });\n  //       if (filteredCells) {\n  //         selectedData = filteredCells;\n  //       }\n  //     } else {\n  //       let filteredCells = isolateData.filter(function(d) {\n  //         return d[searchedColumn]\n  //           .toString()\n  //           .toLowerCase()\n  //           .includes(searchText.toLowerCase());\n  //       });\n  //       if (filteredCells) {\n  //         selectedData = filteredCells;\n  //       }\n  //     }\n  //     let filteredIsolateNames =\n  //       selectedData && selectedData.length > 0\n  //         ? selectedData.map((d) => d.isolate_name)\n  //         : [];\n  //     props.setSelectedData(filteredIsolateNames);\n  //   } else if (searchText === \"\" || searchedColumn === \"\") {\n  //     props.setSelectedData([]);\n  //   }\n  // }, [searchText, searchedColumn]);\n  //HANDLERS\n\n  var onCloseHandler = function onCloseHandler() {\n    props.deactivateChart(props.id);\n  };\n\n  var onTableChangeHandler = function onTableChangeHandler(searchedColumn, searchText, tableData) {\n    var searchTextList = searchText.split(\"::\");\n\n    if (Array.isArray(tableData.currentDataSource)) {\n      if (tableData.currentDataSource.length > 0) {\n        props.setSelectedData(tableData.currentDataSource.map(function (d) {\n          return d.isolate_name;\n        }));\n      } else {\n        var selectedData = [];\n\n        if (searchedColumn === \"isolate_colDate\") {\n          var filteredCells = isolateData.filter(function (d) {\n            var record = dateToStringIS08601(d[searchedColumn]).toString();\n            return searchTextList.indexOf(record) !== -1 ? true : false; //return searchTextList.some((t) => record.includes(t.toLowerCase()));\n          });\n\n          if (filteredCells) {\n            selectedData = filteredCells;\n          }\n        } else {\n          var _filteredCells = isolateData.filter(function (d) {\n            var record = d[searchedColumn].toString();\n            return searchTextList.indexOf(record) !== -1 ? true : false; //return searchTextList.some((t) => record.includes(t.toLowerCase()));\n          });\n\n          if (_filteredCells) {\n            selectedData = _filteredCells;\n          }\n        }\n\n        if (selectedData && selectedData.length > 0) {\n          props.setSelectedData(selectedData.map(function (d) {\n            return d.isolate_name;\n          }));\n        }\n      }\n    }\n  };\n\n  var clearSelectedDataHandler = function clearSelectedDataHandler() {\n    //setSearchText(null);\n    props.setSelectedData([]);\n  };\n\n  var openDrawerHandler = function openDrawerHandler() {\n    setisDrawerVisible(true);\n  };\n\n  var closeDrawerHandler = function closeDrawerHandler() {\n    setisDrawerVisible(false);\n  }; //Util functions\n\n\n  function createHeaders(isolateData) {\n    var raw_headers = isolateData[0];\n    delete raw_headers[\"uid\"];\n    var headers = Object.keys(raw_headers).map(function (key) {\n      var _this2 = this;\n\n      return {\n        key: key,\n        dataIndex: key,\n        title: getIsolateDataHeader(key),\n        filterDropdown: function filterDropdown(_ref) {\n          var setSelectedKeys = _ref.setSelectedKeys,\n              selectedKeys = _ref.selectedKeys,\n              confirm = _ref.confirm,\n              clearFilters = _ref.clearFilters;\n          return /*#__PURE__*/React.createElement(\"div\", {\n            style: {\n              padding: 8\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(Input, {\n            placeholder: \"Filter \".concat(getIsolateDataHeader(key)),\n            value: selectedKeys[0],\n            onChange: function onChange(e) {\n              return setSelectedKeys(e.target.value ? [e.target.value] : []);\n            },\n            onPressEnter: function onPressEnter() {\n              confirm(); // setSearchText(selectedKeys[0]);\n              // setSearchedColumn(key);\n            },\n            style: {\n              width: 188,\n              marginBottom: 8,\n              display: \"block\"\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 13\n            }\n          }), /*#__PURE__*/React.createElement(Space, {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 13\n            }\n          }, /*#__PURE__*/React.createElement(Button, {\n            type: \"primary\",\n            onClick: function onClick() {\n              confirm(); // setSearchText(selectedKeys[0]);\n              // setSearchedColumn(key);\n            },\n            icon: /*#__PURE__*/React.createElement(FilterOutlined, {\n              __self: _this2,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 23\n              }\n            }),\n            size: \"small\",\n            style: {\n              width: 90\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 15\n            }\n          }, \"Filter\"), /*#__PURE__*/React.createElement(Button, {\n            onClick: function onClick() {\n              clearFilters();\n              clearSelectedDataHandler();\n            },\n            size: \"small\",\n            style: {\n              width: 90\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 15\n            }\n          }, \"Reset filter\")));\n        },\n        filteredValue: null,\n        onFilter: function onFilter(value, record) {\n          var searchTextList = value.split(\"::\");\n\n          if (record[key]) {\n            var textInCell = record[key].toString(); //does text in cell are in the search list? !== -1, yes => true, no => false\n\n            var res = searchTextList.indexOf(textInCell) !== -1 ? true : false;\n            return res;\n          } else {\n            return \"\";\n          } // return record[key]\n          //   ? record[key]\n          //       .toString()\n          //       .toLowerCase()\n          //       .includes(value.toLowerCase())\n          //   : \"\";\n\n        },\n        filterIcon: function filterIcon(filtered) {\n          return /*#__PURE__*/React.createElement(FilterOutlined, {\n            style: {\n              color: filtered ? \"#1890ff\" : undefined\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 13\n            }\n          });\n        },\n        filterMultiple: true\n      };\n    });\n    return headers;\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    title: \"Isolates table\",\n    bordered: false,\n    style: {\n      height: \"100%\"\n    },\n    bodyStyle: {\n      padding: \"0px\",\n      width: \"100%\"\n    },\n    extra: /*#__PURE__*/React.createElement(Row, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      span: 8,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"panelHeader\",\n      size: \"small\",\n      style: {\n        margin: \"0 5px\",\n        border: \"none\"\n      },\n      icon: /*#__PURE__*/React.createElement(DragOutlined, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 23\n        }\n      }),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      span: 8,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      size: \"small\",\n      style: {\n        margin: \"0 5px\",\n        border: \"none\"\n      },\n      icon: /*#__PURE__*/React.createElement(SettingOutlined, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 23\n        }\n      }),\n      onClick: openDrawerHandler,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      span: 8,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 13\n      }\n    }, \" \", /*#__PURE__*/React.createElement(Button, {\n      size: \"small\",\n      style: {\n        border: \"none\"\n      },\n      icon: /*#__PURE__*/React.createElement(CloseOutlined, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 23\n        }\n      }),\n      onClick: onCloseHandler,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 15\n      }\n    }))),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"movement-drawer-settings\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DataTableSettings, {\n    isolateData: isolateData,\n    selectedData: props.selectedData,\n    colorScale: props.colorScale,\n    isDrawerVisible: isDrawerVisible,\n    closeDrawerHandler: closeDrawerHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 11\n    }\n  })), !dataTable && /*#__PURE__*/React.createElement(Row, {\n    style: {\n      margin: \"20px\",\n      overflowY: \"auto\",\n      height: props.height - 100\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Skeleton, {\n    active: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 13\n    }\n  })), dataTable && /*#__PURE__*/React.createElement(Row, {\n    style: {\n      margin: \"20px\",\n      overflowY: \"auto\",\n      height: props.height - 100\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      height: \"40px\",\n      marginLeft: \"10px\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 13\n    }\n  }, \"Number of selected isolates: \\xA0\", /*#__PURE__*/React.createElement(\"strong\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 15\n    }\n  }, tableCells.length), \" \\xA0\"), /*#__PURE__*/React.createElement(Button, {\n    onClick: clearSelectedDataHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 13\n    }\n  }, \"Reset\"), /*#__PURE__*/React.createElement(Table, {\n    style: {\n      width: \"100%\",\n      height: props.height - 160\n    },\n    dataSource: tableCells,\n    pagination: {\n      pageSize: 5,\n      showSizeChanger: false,\n      pageSizeOptions: \"[5]\"\n    },\n    columns: tableHeaders,\n    onChange: function onChange(pagination, filters, sorter, extra) {\n      //only trigered when filters are changed\n      var searchedColumn = null;\n      var searchText = null;\n      Object.keys(filters).forEach(function (key) {\n        if (filters[key]) {\n          searchedColumn = key;\n          searchText = filters[key][0]; //get the content of an array\n        }\n      });\n\n      if (searchedColumn && searchText) {\n        onTableChangeHandler(searchedColumn, searchText, extra);\n      }\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }\n  }))));\n};\n\nfunction mapStateToProps(state) {\n  return {\n    data: state.isolateData,\n    selectedData: state.selectedData,\n    colorScale: state.colorScale\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    deactivateChart: deactivateChart,\n    setSelectedData: setSelectedData\n  }, dispatch);\n}\n\nvar MeasuredDataTable = withMeasure(dimensions)(DataTable);\nexport default connect(mapStateToProps, mapDispatchToProps)(MeasuredDataTable); //onChange={function(pagination, filters, sorter, extra) {\n//   console.log(filters);\n// }}\n//sorter: (a, b) => (a[key] > b[key]) - (a[key] < b[key]),\n//sortDirections: [\"descend\"],","map":{"version":3,"sources":["/Volumes/DATA/BUDI/APP_DEV/haiviz-v04/src/viz_DataTable/comp_DataTable.js"],"names":["React","useState","useEffect","connect","bindActionCreators","deactivateChart","setSelectedData","Row","Col","Card","Button","Table","Skeleton","Input","Space","DataTableSettings","DragOutlined","SettingOutlined","CloseOutlined","FilterOutlined","dateToStringIS08601","getIsolateDataHeader","withMeasure","dimensions","_","require","DataTable","props","isDrawerVisible","setisDrawerVisible","isolateData","cloneDeep","Array","from","data","values","dataTable","headers","cells","map","d","idx","key","isolate_name","isolate_species","isolate_sourceType","isolate_sourceName","isolate_colDate","isolate_colLocation","profile_1","profile_2","profile_3","tableCells","setTableCells","tableHeaders","createHeaders","selectedData","length","filteredCells","filter","indexOf","onCloseHandler","id","onTableChangeHandler","searchedColumn","searchText","tableData","searchTextList","split","isArray","currentDataSource","record","toString","clearSelectedDataHandler","openDrawerHandler","closeDrawerHandler","raw_headers","Object","keys","dataIndex","title","filterDropdown","setSelectedKeys","selectedKeys","confirm","clearFilters","padding","e","target","value","width","marginBottom","display","filteredValue","onFilter","textInCell","res","filterIcon","filtered","color","undefined","filterMultiple","height","margin","border","colorScale","overflowY","marginLeft","pageSize","showSizeChanger","pageSizeOptions","pagination","filters","sorter","extra","forEach","mapStateToProps","state","mapDispatchToProps","dispatch","MeasuredDataTable"],"mappings":"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","sourcesContent":["/* ============================================================================\n============================================================================ */\nimport React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { deactivateChart, setSelectedData } from \"../action/index\";\nimport { Row, Col, Card, Button, Table, Skeleton, Input, Space } from \"antd\";\nimport DataTableSettings from \"./comp_DataTable_Settings\";\nimport {\n  DragOutlined,\n  SettingOutlined,\n  CloseOutlined,\n  FilterOutlined,\n} from \"@ant-design/icons\";\nimport { dateToStringIS08601, getIsolateDataHeader } from \"../utils/utils\";\n//import { ExportToCsv } from \"export-to-csv\";\n\nimport withMeasure from \"../hocs/withMeasure\";\n\nconst dimensions = [\"width\", \"height\"];\nconst _ = require(\"lodash\");\n\nconst DataTable = (props) => {\n  const [isDrawerVisible, setisDrawerVisible] = useState(false);\n  const isolateData = _.cloneDeep(Array.from(props.data.values()));\n  // const [searchText, setSearchText] = useState(null);\n  // const [searchedColumn, setSearchedColumn] = useState(null);\n  const dataTable = { headers: null, cells: null };\n  const cells =\n    isolateData && isolateData[0]\n      ? isolateData.map((d, idx) => {\n          return {\n            key: idx,\n            isolate_name: d.isolate_name,\n            isolate_species: d.isolate_species,\n            isolate_sourceType: d.isolate_sourceType,\n            isolate_sourceName: d.isolate_sourceName,\n            isolate_colDate: dateToStringIS08601(d.isolate_colDate),\n            isolate_colLocation: d.isolate_colLocation,\n            profile_1: d.profile_1,\n            profile_2: d.profile_2,\n            profile_3: d.profile_3,\n          };\n        })\n      : null;\n  const [tableCells, setTableCells] = useState(cells);\n  const tableHeaders =\n    isolateData && isolateData[0] ? createHeaders(isolateData) : null;\n\n  //USE EFFECTS\n  useEffect(() => {\n    if (props.selectedData) {\n      let tableCells = isolateData.map((d, idx) => {\n        return {\n          key: idx,\n          isolate_name: d.isolate_name,\n          isolate_species: d.isolate_species,\n          isolate_sourceType: d.isolate_sourceType,\n          isolate_sourceName: d.isolate_sourceName,\n          isolate_colDate: dateToStringIS08601(d.isolate_colDate),\n          isolate_colLocation: d.isolate_colLocation,\n          profile_1: d.profile_1,\n          profile_2: d.profile_2,\n          profile_3: d.profile_3,\n        };\n      });\n      if (props.selectedData.length > 0) {\n        let filteredCells = tableCells.filter((d) => {\n          return props.selectedData.indexOf(d.isolate_name) !== -1;\n        });\n        setTableCells(filteredCells);\n      } else {\n        setTableCells(tableCells);\n      }\n    }\n  }, [props.selectedData]);\n\n  // useEffect(() => {\n  //   if (\n  //     searchText &&\n  //     searchedColumn &&\n  //     searchText !== \"\" &&\n  //     searchedColumn !== \"\"\n  //   ) {\n  //     let selectedData = [];\n  //     if (searchedColumn === \"isolate_colDate\") {\n  //       let filteredCells = isolateData.filter(function(d) {\n  //         return dateToStringIS08601(d[searchedColumn])\n  //           .toString()\n  //           .toLowerCase()\n  //           .includes(searchText.toLowerCase());\n  //       });\n  //       if (filteredCells) {\n  //         selectedData = filteredCells;\n  //       }\n  //     } else {\n  //       let filteredCells = isolateData.filter(function(d) {\n  //         return d[searchedColumn]\n  //           .toString()\n  //           .toLowerCase()\n  //           .includes(searchText.toLowerCase());\n  //       });\n  //       if (filteredCells) {\n  //         selectedData = filteredCells;\n  //       }\n  //     }\n  //     let filteredIsolateNames =\n  //       selectedData && selectedData.length > 0\n  //         ? selectedData.map((d) => d.isolate_name)\n  //         : [];\n  //     props.setSelectedData(filteredIsolateNames);\n  //   } else if (searchText === \"\" || searchedColumn === \"\") {\n  //     props.setSelectedData([]);\n  //   }\n  // }, [searchText, searchedColumn]);\n\n  //HANDLERS\n  const onCloseHandler = () => {\n    props.deactivateChart(props.id);\n  };\n\n  const onTableChangeHandler = (searchedColumn, searchText, tableData) => {\n    const searchTextList = searchText.split(\"::\");\n    if (Array.isArray(tableData.currentDataSource)) {\n      if (tableData.currentDataSource.length > 0) {\n        props.setSelectedData(\n          tableData.currentDataSource.map((d) => d.isolate_name)\n        );\n      } else {\n        let selectedData = [];\n        if (searchedColumn === \"isolate_colDate\") {\n          let filteredCells = isolateData.filter(function(d) {\n            let record = dateToStringIS08601(d[searchedColumn]).toString();\n            return searchTextList.indexOf(record) !== -1 ? true : false;\n            //return searchTextList.some((t) => record.includes(t.toLowerCase()));\n          });\n          if (filteredCells) {\n            selectedData = filteredCells;\n          }\n        } else {\n          let filteredCells = isolateData.filter(function(d) {\n            let record = d[searchedColumn].toString();\n            return searchTextList.indexOf(record) !== -1 ? true : false;\n            //return searchTextList.some((t) => record.includes(t.toLowerCase()));\n          });\n\n          if (filteredCells) {\n            selectedData = filteredCells;\n          }\n        }\n        if (selectedData && selectedData.length > 0) {\n          props.setSelectedData(selectedData.map((d) => d.isolate_name));\n        }\n      }\n    }\n  };\n\n  const clearSelectedDataHandler = () => {\n    //setSearchText(null);\n    props.setSelectedData([]);\n  };\n  const openDrawerHandler = () => {\n    setisDrawerVisible(true);\n  };\n  const closeDrawerHandler = () => {\n    setisDrawerVisible(false);\n  };\n\n  //Util functions\n  function createHeaders(isolateData) {\n    let raw_headers = isolateData[0];\n    delete raw_headers[\"uid\"];\n    let headers = Object.keys(raw_headers).map(function(key) {\n      return {\n        key: key,\n        dataIndex: key,\n        title: getIsolateDataHeader(key),\n        filterDropdown: ({\n          setSelectedKeys,\n          selectedKeys,\n          confirm,\n          clearFilters,\n        }) => (\n          <div style={{ padding: 8 }}>\n            <Input\n              placeholder={`Filter ${getIsolateDataHeader(key)}`}\n              value={selectedKeys[0]}\n              onChange={(e) =>\n                setSelectedKeys(e.target.value ? [e.target.value] : [])\n              }\n              onPressEnter={() => {\n                confirm();\n                // setSearchText(selectedKeys[0]);\n                // setSearchedColumn(key);\n              }}\n              style={{ width: 188, marginBottom: 8, display: \"block\" }}\n            />\n            <Space>\n              <Button\n                type=\"primary\"\n                onClick={() => {\n                  confirm();\n                  // setSearchText(selectedKeys[0]);\n                  // setSearchedColumn(key);\n                }}\n                icon={<FilterOutlined />}\n                size=\"small\"\n                style={{ width: 90 }}\n              >\n                Filter\n              </Button>\n              <Button\n                onClick={() => {\n                  clearFilters();\n                  clearSelectedDataHandler();\n                }}\n                size=\"small\"\n                style={{ width: 90 }}\n              >\n                Reset filter\n              </Button>\n            </Space>\n          </div>\n        ),\n        filteredValue: null,\n        onFilter: function(value, record) {\n          const searchTextList = value.split(\"::\");\n          if (record[key]) {\n            const textInCell = record[key].toString();\n            //does text in cell are in the search list? !== -1, yes => true, no => false\n            const res =\n              searchTextList.indexOf(textInCell) !== -1 ? true : false;\n            return res;\n          } else {\n            return \"\";\n          }\n          // return record[key]\n          //   ? record[key]\n          //       .toString()\n          //       .toLowerCase()\n          //       .includes(value.toLowerCase())\n          //   : \"\";\n        },\n        filterIcon: function(filtered) {\n          return (\n            <FilterOutlined\n              style={{ color: filtered ? \"#1890ff\" : undefined }}\n            />\n          );\n        },\n        filterMultiple: true,\n      };\n    });\n    return headers;\n  }\n\n  return (\n    <React.Fragment>\n      <Card\n        title={\"Isolates table\"}\n        bordered={false}\n        style={{ height: \"100%\" }}\n        bodyStyle={{ padding: \"0px\", width: \"100%\" }}\n        extra={\n          <Row>\n            <Col span={8}>\n              <Button\n                className=\"panelHeader\"\n                size={\"small\"}\n                style={{ margin: \"0 5px\", border: \"none\" }}\n                icon={<DragOutlined />}\n              ></Button>\n            </Col>\n            <Col span={8}>\n              <Button\n                size={\"small\"}\n                style={{ margin: \"0 5px\", border: \"none\" }}\n                icon={<SettingOutlined />}\n                onClick={openDrawerHandler}\n              ></Button>\n            </Col>\n            <Col span={8}>\n              {\" \"}\n              <Button\n                size={\"small\"}\n                style={{ border: \"none\" }}\n                icon={<CloseOutlined />}\n                onClick={onCloseHandler}\n              ></Button>\n            </Col>\n          </Row>\n        }\n      >\n        <div id=\"movement-drawer-settings\">\n          <DataTableSettings\n            isolateData={isolateData}\n            selectedData={props.selectedData}\n            colorScale={props.colorScale}\n            isDrawerVisible={isDrawerVisible}\n            closeDrawerHandler={closeDrawerHandler}\n          />\n        </div>\n        {!dataTable && (\n          <Row\n            style={{\n              margin: \"20px\",\n              overflowY: \"auto\",\n              height: props.height - 100,\n            }}\n          >\n            <Skeleton active />\n          </Row>\n        )}\n        {dataTable && (\n          <Row\n            style={{\n              margin: \"20px\",\n              overflowY: \"auto\",\n              height: props.height - 100,\n            }}\n          >\n            <p style={{ height: \"40px\", marginLeft: \"10px\" }}>\n              Number of selected isolates: &nbsp;\n              <strong>{tableCells.length}</strong> &nbsp;\n            </p>\n            <Button onClick={clearSelectedDataHandler}>Reset</Button>\n            <Table\n              style={{\n                width: \"100%\",\n                height: props.height - 160,\n              }}\n              dataSource={tableCells}\n              pagination={{\n                pageSize: 5,\n                showSizeChanger: false,\n                pageSizeOptions: \"[5]\",\n              }}\n              columns={tableHeaders}\n              onChange={function(pagination, filters, sorter, extra) {\n                //only trigered when filters are changed\n                let searchedColumn = null;\n                let searchText = null;\n                Object.keys(filters).forEach(function(key) {\n                  if (filters[key]) {\n                    searchedColumn = key;\n                    searchText = filters[key][0]; //get the content of an array\n                  }\n                });\n                if (searchedColumn && searchText) {\n                  onTableChangeHandler(searchedColumn, searchText, extra);\n                }\n              }}\n            />\n          </Row>\n        )}\n      </Card>\n    </React.Fragment>\n  );\n};\n\nfunction mapStateToProps(state) {\n  return {\n    data: state.isolateData,\n    selectedData: state.selectedData,\n    colorScale: state.colorScale,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      deactivateChart: deactivateChart,\n      setSelectedData: setSelectedData,\n    },\n    dispatch\n  );\n}\n\nconst MeasuredDataTable = withMeasure(dimensions)(DataTable);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MeasuredDataTable);\n//onChange={function(pagination, filters, sorter, extra) {\n//   console.log(filters);\n// }}\n//sorter: (a, b) => (a[key] > b[key]) - (a[key] < b[key]),\n//sortDirections: [\"descend\"],\n"]},"metadata":{},"sourceType":"module"}